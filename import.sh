#! /bin/bash
#				╔════════════════════════════════════════════════════════════════════════════════╗
#				║████████████████████████████████████████████████████████████████████████████████║
#				║████████████████████████████████████████████████████████████████████████████████║
#				║████████████████████████████████████████████████████████████████████████████████║
#				║██████████@@@@@@@████@@@@@@███@@@██@@@███@@@@@@@@██@@@@@@@@██@@@@@@@████████████║
#				║██████████@@@@@@@@██@@@@@@@@██@@@@█@@@██@@@@@@@@@██@@@@@@@@██@@@@@@@@███████████║
#				║██████████@@!██@@@██@@!██@@@██@@!@!@@@██!@@████████@@!███████@@!██@@@███████████║
#				║██████████!@!██@!@██!@!██@!@██!@!!@!@!██!@!████████!@!███████!@!██@!@███████████║
#				║██████████@!@██!@!██@!@!@!@!██@!@█!!@!██!@!█@!@!@██@!!!:!████@!@!!@!████████████║
#				║██████████!@!██!!!██!!!@!!!!██!@!██!!!██!!!█!!@!!██!!!!!:████!!@!@!█████████████║
#				║██████████!!:██!!!██!!:██!!!██!!:██!!!██:!!███!!:██!!:███████!!:█:!!████████████║
#				║██████████:!:██!:!██:!:██!:!██:!:██!:!██:!:███!::██:!:███████:!:██!:!███████████║
#				║███████████::::█::██::███:::███::███::███:::█::::███::█::::██::███:::███████████║
#				║██████████::█:██:████:███:█:██::████:████::█::█:███:█::█::████:███:█:███████████║
#				║████████████████████████████████████████████████████████████████████████████████║
#				║████████████████████████████████████████████████████████████████████████████████║
#				║████████████████████@@@@@@@@███@@@@@@███@@@██@@@██@@@@@@@@██████████████████████║
#				║████████████████████@@@@@@@@██@@@@@@@@██@@@@█@@@██@@@@@@@@██████████████████████║
#				║█████████████████████████@@!██@@!██@@@██@@!@!@@@██@@!███████████████████████████║
#				║████████████████████████!@!███!@!██@!@██!@!!@!@!██!@!███████████████████████████║
#				║███████████████████████@!!████@!@██!@!██@!@█!!@!██@!!!:!████████████████████████║
#				║██████████████████████!!!█████!@!██!!!██!@!██!!!██!!!!!:████████████████████████║
#				║█████████████████████!!:██████!!:██!!!██!!:██!!!██!!:███████████████████████████║
#				║████████████████████:!:███████:!:██!:!██:!:██!:!██:!:███████████████████████████║
#				║█████████████████████::█::::██:::::█::███::███::███::█::::██████████████████████║
#				║████████████████████:█::█:█:███:█:██:███::████:███:█::█::███████████████████████║
#				║████████████████████████████████████████████████████████████████████████████████║
#				║████████████████████████████████████████████████████████████████████████████████║
#				║████████████████████████████████████████████████████████████████████████████████║
#				╚════════════════════════════════════════════════════════════════════════════════╝
## This script modifies your Rancher environment.
## It's also not tested and has no safeguards against anything.
## You've been warned.
##
## Usage: ./import <environment_name>. Assumes exports exist in ./export
##########################################################################################

if [ -x $1 ]; then
	echo "Enter an environment name. It's a directory under 'export'. If unsure, stop now and seek help."
	exit 1
fi

## This sets the env vars
export $(grep IMPORT .env.import |xargs)

cd ./export/$1

for d in $(find * -maxdepth 1 -type d); do
	cd $d
	echo "In $(pwd)"
	rancher-compose --access-key $RANCHER_IMPORT_ENV_KEY --secret-key $RANCHER_IMPORT_ENV_SECRET --url $RANCHER_IMPORT_URL create
	cd ..
done

